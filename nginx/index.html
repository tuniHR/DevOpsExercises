<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Service Load Balancer</title>
    <script>
        async function sendRequest() {
            try {
                const response = await fetch('/api');
                const data = await response.json();
                document.getElementById("responseArea").value = JSON.stringify(data);
            } catch (error) {
                document.getElementById("responseArea").value = "Error fetching data.";
            }
        }

        async function stopService() {
            
                try {
                    const response = await fetch('/stop', { method: 'POST' });
                    const result = await response.json();
                    alert(result.message || result.error);
                } catch (error) {
                    alert("Error stopping services.");
                }
            
        }

        // This function runs once the document is fully loaded
        document.addEventListener('DOMContentLoaded', (event) => {
            console.log("Document fully loaded and parsed!");
            
            UpdateToRunning(); 
        });

        async function UpdateToRunning() {
            try {
                const response = await fetch('/login', {method: 'POST'});
                const data = await response.json();
                document.getElementById("responseArea").value = JSON.stringify(data);
            } catch (error) {
                document.getElementById("responseArea").value = "Error fetching data.";
            }
        }
    </script>
</head>
<body>
    <h1>Service Load Balancer Interface</h1>
    <button onclick="sendRequest()">REQUEST</button>
    <textarea id="responseArea" rows="10" cols="30"></textarea>
    <button onclick="stopService()">STOP</button>
</body>
</html>